# -*- coding: utf-8 -*-
"""
Created on Tue May  1 19:35:08 2018

@author: fnord
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

def set_box_color(bp, color):
    plt.setp(bp['boxes'], color=color)
    plt.setp(bp['whiskers'], color=color)
    plt.setp(bp['caps'], color=color)
    plt.setp(bp['medians'], color=color)

dbs= ('Arabidopsis_non_tata', 'Arabidopsis_tata', 'Bacillus', 'Ecoli', 'Human_non_tata', 'Mouse_non_tata', 'Mouse_tata')
liminf = (.85, .92, .7, .7, .65, .8, .9)
metrics = ('Sn', 'Sp', 'Acc', 'Prec', 'F1', 'Mcc')

################################################################################# Bacillus

org = 4

caps = [
    # Arabidopsis_non_tata
    [[0.9357021997, 0.9576988156, 0.9661590525, 0.9560067682, 0.9610829103], # Sn
    [0.9589877836, 0.9197207679, 0.9406631763, 0.9554973822, 0.9345549738], # Sp
    [0.9510650547, 0.932642487, 0.949337939, 0.9556706966, 0.9435808866], # Acc
    [0.9216666667, 0.8601823708, 0.8935837246, 0.9172077922, 0.8833592535], # Prec
    [0.9286314022, 0.90632506, 0.9284552846, 0.9362054681, 0.9205834684], # F1    
    [0.8914618592, 0.8569780601, 0.8909567193, 0.9027168258, 0.8788289546]], # Mcc
    # Arabidopsis_tata
    [[0.9866666667, 1, 0.9866666667, 0.9866666667, 0.9933333333],
    [0.96875, 0.9756944444, 0.9722222222, 0.9791666667, 0.9722222222],
    [0.9748858447, 0.9840182648, 0.9771689498, 0.9817351598, 0.9794520548],
    [0.9426751592, 0.9554140127, 0.9487179487, 0.961038961, 0.949044586],
    [0.9641693811, 0.9771986971, 0.9673202614, 0.9736842105, 0.9706840391],   
    [0.9454350532, 0.965500981, 0.9502181167, 0.9598967757, 0.9554680171]],
    # Bacillus
    [[0.9459459459, 0.8648648649, 0.8108108108, 0.972972973, 0.8918918919],
    [0.9603960396, 0.9504950495, 0.9504950495, 0.9603960396, 0.9306930693],
    [0.9565217391, 0.9275362319, 0.9130434783, 0.9637681159, 0.9202898551],
    [0.8974358974, 0.8648648649, 0.8571428571, 0.9, 0.825],
    [0.9210526316, 0.8648648649, 0.8333333333, 0.9350649351, 0.8571428571],
    [0.8916691618, 0.8153599144, 0.7751184729, 0.9113220823, 0.8031548397]], 
    # Ecoli
    [[0.9047619048, 0.8571428571, 0.8571428571, 0.8095238095, 0.8571428571],
    [0.97, 0.9733333333, 0.98, 0.97, 0.9366666667],
    [0.9557291667, 0.9479166667, 0.953125, 0.9348958333, 0.9192708333],
    [0.8941176471, 0.9, 0.9230769231, 0.8831168831, 0.7912087912],
    [0.899408284, 0.8780487805, 0.8888888889, 0.8447204969, 0.8228571429],
    [0.871053991, 0.8453677404, 0.8601849342, 0.8048502898, 0.771724111]],
    # Human_non_tata
    # [[0.7915194346, 0.8647147905, 0.8581524483, 0.8662291772, 0.8844018173],
    # [0.8860850757, 0.8237202596, 0.8262436914, 0.8529199712, 0.8136265321],
    # [0.8466876972, 0.8407991588, 0.8395373291, 0.8584647739, 0.8431125131],
    # [0.8322717622, 0.7779291553, 0.7791017415, 0.8079096045, 0.77214632],
    # [0.8113842173, 0.8190294047, 0.8167187125, 0.8360535932, 0.8244705882],
    # [0.6829905721, 0.6806508242, 0.6771045796, 0.7131432179, 0.6889706433]],

    [[0.8293791015, 0.834427057, 0.8374558304, 0.8465421504, 0.8414941949],
    [0.9069935112, 0.8741888969, 0.8990627253, 0.8994232156, 0.8691420332],
    [0.8746582545, 0.8576235542, 0.8733964248, 0.8773922187, 0.8576235542],
    [0.8642819569, 0.8256743257, 0.8555956679, 0.8573619632, 0.821182266],
    [0.8464708913, 0.8300276174, 0.8464285714, 0.8519177038, 0.8312141611],
    [0.7410969929, 0.7075729956, 0.7388800306, 0.7473572571, 0.7082906973]],
    # Mouse_non_tata
    [[0.9422604423, 0.9232186732, 0.8826781327, 0.9391891892, 0.9361179361],
    [0.8916633105, 0.8936770036, 0.9287152638, 0.9142166734, 0.9154248892],
    [0.9117003162, 0.905375821, 0.9104840671, 0.9241060569, 0.9236195573],
    [0.8508042152, 0.8505942275, 0.8903345725, 0.8777267509, 0.8788927336],
    [0.8941999417, 0.8854197349, 0.8864898211, 0.9074183976, 0.9066032124],
    [0.8219135468, 0.8070214523, 0.8126171665, 0.8446262532, 0.8433015854]],
    # Mouse_tata
    [[0.9841269841, 0.9761904762, 0.9761904762, 0.9682539683, 0.9603174603],
    [0.9745042493, 0.9745042493, 0.9688385269, 0.9631728045, 0.9745042493],
    [0.9770354906, 0.9749478079, 0.9707724426, 0.9645093946, 0.9707724426],
    [0.9323308271, 0.9318181818, 0.9179104478, 0.9037037037, 0.9307692308],
    [0.9575289575, 0.9534883721, 0.9461538462, 0.9348659004, 0.9453125],
    [0.9424543648, 0.9368326253, 0.9269489478, 0.9115389626, 0.9255865289]],
]

conv = [
    # Arabidopsis_non_tata
    [[0.9255499154, 0.9018612521, 0.9052453469, 0.923857868, 0.8984771574],
    [0.9685863874, 0.9659685864, 0.9554973822, 0.9616055846, 0.9703315881],
    [0.9539435809, 0.9441565918, 0.9383995394, 0.9487622337, 0.9458837075],
    [0.9382504288, 0.9318181818, 0.9129692833, 0.9254237288, 0.9398230088],
    [0.9318568995, 0.9165950129, 0.9090909091, 0.9246401355, 0.9186851211],
    [0.8971242486, 0.8749024859, 0.8625274834, 0.8858271255, 0.8786627259]],
    # Arabidopsis_tata
    [[0.9733333333, 0.9666666667, 0.9466666667, 0.96, 1],
    [0.9722222222, 0.9895833333, 0.9791666667, 0.9930555556, 0.96875],
    [0.9726027397, 0.9817351598, 0.9680365297, 0.9817351598, 0.9794520548],
    [0.9480519481, 0.9797297297, 0.9594594595, 0.9863013699, 0.9433962264],
    [0.9605263158, 0.9731543624, 0.9530201342, 0.972972973, 0.9708737864],
    [0.9397436366, 0.9593641045, 0.9288483836, 0.9593834826, 0.955989066]],
    # Bacillus
    [[0.9189189189, 0.9189189189, 0.8108108108, 0.9459459459, 0.7837837838],
    [0.9603960396, 0.9801980198, 0.9405940594, 0.9603960396, 0.9306930693],
    [0.9492753623, 0.9637681159, 0.9057971014, 0.9565217391, 0.8913043478],
    [0.8947368421, 0.9444444444, 0.8333333333, 0.8974358974, 0.8055555556],
    [0.9066666667, 0.9315068493, 0.8219178082, 0.9210526316, 0.7945205479],
    [0.871995436, 0.9070399009, 0.7580262029, 0.8916691618, 0.7207727784]],
    # Ecoli
    [[0.9285714286, 0.8571428571, 0.8333333333, 0.8452380952, 0.869047619],
    [0.9666666667, 0.9766666667, 0.9866666667, 0.9766666667, 0.9666666667],
    [0.9583333333, 0.9505208333, 0.953125, 0.9479166667, 0.9453125],
    [0.8863636364, 0.9113924051, 0.9459459459, 0.9102564103, 0.8795180723],
    [0.9069767442, 0.8834355828, 0.8860759494, 0.8765432099, 0.874251497],
    [0.880545158, 0.8527145165, 0.8594436675, 0.8445274155, 0.8393359065]],
    # Human_non_tata
    [[0.8849066128, 0.9066128218, 0.8919737506, 0.9066128218, 0.930338213],
    [0.9909877433, 0.9866618601, 0.9881038212, 0.9819754867, 0.963229992],
    [0.9467928496, 0.9533123028, 0.9480546793, 0.9505783386, 0.9495268139],
    [0.9859392576, 0.9798145117, 0.9816666667, 0.9729144095, 0.9475578406],
    [0.9326948657, 0.9417933928, 0.9346733668, 0.9385941991, 0.9388690779],
    [0.8924664491, 0.904813669, 0.8945434177, 0.8988937316, 0.8960045417]],
    # Mouse_non_tata
    [[0.8814496314, 0.8574938575, 0.8968058968, 0.8734643735, 0.8961916462],
    [0.9536850584, 0.960531615, 0.9343536045, 0.9661699557, 0.935964559],
    [0.9250790562, 0.9197275602, 0.9194843104, 0.9294575529, 0.92021405],
    [0.9258064516, 0.9344042838, 0.8995686999, 0.9442231076, 0.9017305315],
    [0.9030837004, 0.8942985266, 0.8981851738, 0.9074664965, 0.898952557],
    [0.842755209, 0.8317737826, 0.831601925, 0.8522939332, 0.8330479848]],
    # Mouse_tata
    [[0.9523809524, 0.9365079365, 0.9365079365, 0.9365079365, 0.9603174603],
    [0.9773371105, 0.9830028329, 0.9830028329, 0.9745042493, 0.9801699717],
    [0.9707724426, 0.9707724426, 0.9707724426, 0.9645093946, 0.9749478079],
    [0.9375, 0.9516129032, 0.9516129032, 0.9291338583, 0.9453125],
    [0.9448818898, 0.944, 0.944, 0.9328063241, 0.9527559055],
    [0.9250503054, 0.9242818528, 0.9242818528, 0.9087064679, 0.9357656056]],  
]


plt.figure()

bpl = plt.boxplot(caps[org], positions=np.array(range(len(caps[org])))*2.0-0.4, sym='', widths=0.6)
bpr = plt.boxplot(conv[org], positions=np.array(range(len(conv[org])))*2.0+0.4, sym='', widths=0.6)
set_box_color(bpl, '#D7191C') # colors are from http://colorbrewer2.org/
set_box_color(bpr, '#2C7BB6')

# draw temporary red and blue lines and use them to create a legend
plt.plot([], c='#D7191C', label='CapsNet')
plt.plot([], c='#2C7BB6', label='ConvNet')
plt.legend()

plt.xticks(range(0, len(metrics) * 2, 2), metrics)
plt.xlim(-2, len(metrics)*2)
plt.ylim(liminf[org], 1)
plt.tight_layout()
plt.title(dbs[org])
plt.legend(loc='bottom left', shadow=False)

figname = 'results_boxplot-{}.eps'.format(dbs[org])
plt.savefig(figname , format='eps', dpi=3000)
plt.show()



#ind = np.arange(len(cnn))
#width = 0.2
#
#ax = plt.subplot(111)
#ax.bar(ind, cnn, width, color='#EDC951', label='CNN')
#ax.bar(ind+width, caps, width, yerr=std, color='#EB6841', label='CapsNet')
#
#ax.set_ylabel('Sp')
#plt.xticks(ind, , rotation='vertical')
##plt.subplots_adjust(top=10.0)
#
##ax.legend(loc='upper right', shadow=True)
#plt.title("Comparação da Especificidade")
##plt.legend(loc='upper left', prop={'size':10}, bbox_to_anchor=(1,1))
#plt.legend(loc='bottom right')
#
#
#
#
#plt.tight_layout()
#plt.savefig('comp_sp.eps', format='eps', dpi=1000)
#plt.show()


print('END')